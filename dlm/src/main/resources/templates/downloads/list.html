<!doctype html>
<html lang="uk" xmlns:th="http://www.thymeleaf.org">
<th:block th:replace="~{base :: head('–ú–æ—ó –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è')}"></th:block>

<body data-page="downloads">
<th:block th:replace="~{base :: header}"></th:block>

<th:block th:replace="~{base :: container(~{::content})}">
    <th:block th:fragment="content">
        <section class="page">

            <div class="alert" role="alert" aria-live="polite">
                <div class="alert--error" th:if="${error}" th:text="${error}"></div>
            </div>

            <div class="card card--form" aria-labelledby="addTitle">
                <h2 id="addTitle" class="h3">–î–æ–¥–∞—Ç–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è</h2>
                <form class="form" th:action="@{/downloads}" th:object="${form}" method="post" novalidate>
                    <div class="input-group input-group--block" data-input-group>
                        <input type="url" th:field="*{url}" placeholder="https://..." required
                               inputmode="url" class="mono" aria-label="URL –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è"/>
                        <button type="submit" class="btn btn--primary input-group__btn">–î–æ–¥–∞—Ç–∏</button>
                    </div>
                    <small class="help">–í—Å—Ç–∞–≤—Ç–µ –ø–æ–≤–Ω–∏–π URL —Ñ–∞–π–ª—É</small>
                </form>
            </div>

            <div class="card" aria-labelledby="listTitle">
                <h2 id="listTitle" class="h3">–°–ø–∏—Å–æ–∫</h2>

                <div class="table-wrap">
                    <table class="table table--responsive">
                        <thead>
                        <tr>
                            <th scope="col">URL</th>
                            <th scope="col">–§–∞–π–ª</th>
                            <th scope="col">–°—Ç–∞—Ç—É—Å</th>
                            <th scope="col">–ü—Ä–æ–≥—Ä–µ—Å</th>
                            <th scope="col">–î—ñ—ó</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="d : ${items}">
                            <td data-col="URL"><span class="mono" th:text="${d.url}">url</span></td>
                            <td data-col="–§–∞–π–ª"><span class="mono" th:text="${d.fileName} ?: '-'">file</span></td>
                            <td data-col="–°—Ç–∞—Ç—É—Å">
                    <span class="badge"
                          th:classappend="
                            ${d.status}=='RUNNING' ? ' badge--running' :
                            (${d.status}=='PAUSED' ? ' badge--paused' :
                            (${d.status}=='CANCELED' ? ' badge--canceled' : ' badge--default'))"
                          th:text="${d.status}">status</span>
                            </td>
                            <td data-col="–ü—Ä–æ–≥—Ä–µ—Å">
                                <div class="progress" th:with="rec=${d.receivedBytes}, tot=${d.totalBytes}">
                                    <div class="progress__nums">
                                        <span class="mono" th:text="${rec}">0</span>/<span class="mono" th:text="${tot}">0</span>
                                    </div>
                                    <div class="progress__bar">
                                        <div class="progress__bar-fill"
                                             th:attr="data-received=${rec},data-total=${tot}"
                                             role="progressbar"
                                             aria-label="–ü—Ä–æ–≥—Ä–µ—Å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è"
                                             aria-valuemin="0"
                                             aria-valuemax="100"
                                             aria-valuenow="0"></div>
                                    </div>
                                    <div class="progress__hint" data-wait th:if="${d.totalBytes} == 0">–û—á—ñ–∫—É–≤–∞–Ω–Ω—è‚Ä¶</div>
                                </div>
                            </td>
                            <td data-col="–î—ñ—ó">
                                <div class="actions">
                                    <form th:action="@{|/downloads/${d.id}/status|}" method="post" class="inline">
                                        <input type="hidden" name="s" value="RUNNING"/>
                                        <button type="submit" class="btn btn--primary btn--sm"
                                                title="–°—Ç–∞—Ä—Ç" aria-label="–°—Ç–∞—Ä—Ç">‚ñ∂</button>
                                    </form>
                                    <form th:action="@{|/downloads/${d.id}/status|}" method="post" class="inline">
                                        <input type="hidden" name="s" value="PAUSED"/>
                                        <button type="submit" class="btn btn--ghost btn--sm"
                                                title="–ü–∞—É–∑–∞" aria-label="–ü–∞—É–∑–∞">‚è∏</button>
                                    </form>
                                    <form th:action="@{|/downloads/${d.id}/status|}" method="post" class="inline">
                                        <input type="hidden" name="s" value="CANCELED"/>
                                        <button type="submit" class="btn btn--danger btn--sm"
                                                title="–°–∫–∞—Å—É–≤–∞—Ç–∏" aria-label="–°–∫–∞—Å—É–≤–∞—Ç–∏">‚èπ</button>
                                    </form>
                                    <form th:action="@{|/downloads/${d.id}/delete|}" method="post" class="inline"
                                          data-confirm="–í–∏–¥–∞–ª–∏—Ç–∏ —Ü–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –±–µ–∑–ø–æ–≤–æ—Ä–æ—Ç–Ω–æ?">
                                        <button type="submit" class="btn btn--danger btn--sm"
                                                title="–í–∏–¥–∞–ª–∏—Ç–∏" aria-label="–í–∏–¥–∞–ª–∏—Ç–∏">üóë</button>
                                    </form>
                                </div>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>

            </div>
        </section>

        <div class="modal" id="confirmModal" role="dialog" aria-modal="true"
             aria-hidden="true" aria-labelledby="confirmTitle" aria-describedby="confirmText">
            <div class="modal__backdrop" data-close></div>
            <div class="modal__dialog" role="document">
                <h3 id="confirmTitle" class="h4">–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è</h3>
                <p id="confirmText">–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ?</p>
                <div class="modal__actions">
                    <button type="button" class="btn btn--ghost" data-close>–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
                    <button type="button" class="btn btn--danger" id="confirmOk">–¢–∞–∫, –≤–∏–¥–∞–ª–∏—Ç–∏</button>
                </div>
            </div>
        </div>
    </th:block>
</th:block>

<th:block th:replace="~{base :: footer}"></th:block>
</body>
</html>
